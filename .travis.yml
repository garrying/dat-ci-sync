language: ruby
rvm:
  - 2.6.0
env:
  -DAT_HASH="dat://0b658ddf53463118ded55ff7b1204fe32f1d10f4b679ef859c7d9d06725e8f3b"

before_install:
  - gem update --system
  - gem install bundler
  - curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.34.0/install.sh | bash
  - nvm install 10.15.3
  - npm i -g dat

before_script:
  - dat clone $DAT_HASH ./_site --exit
  - bundle exec jekyll build

addons:
  apt:
    packages:
    - libcurl4-openssl-dev

env:
  global:
  - NOKOGIRI_USE_SYSTEM_LIBRARIES=true

cache: bundler

script: travis_retry bundle exec htmlproofer --check-html --allow-hash-href ./_site

notifications:
  email: false
